(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/history/history"],{"34e0":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=(t._self._c,(new Date).getFullYear());t.$mp.data=Object.assign({},{$root:{g0:a}})},o=[];a.d(e,"a",function(){return n}),a.d(e,"b",function(){return o})},3862:function(t,e,a){"use strict";a.r(e);var n=a("6754"),o=a.n(n);for(var i in n)"default"!==i&&function(t){a.d(e,t,function(){return n[t]})}(i);e["default"]=o.a},6754:function(t,e,a){"use strict";(function(t,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o,i=r(a("129b"));function r(t){return t&&t.__esModule?t:{default:t}}function c(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var u=null,d=null;function s(t){var e=new Date,a=e.getFullYear(),n=e.getMonth()+1,o=e.getDate(),i=e.getHours();return 0==t?"".concat(a,"-").concat(n,"-").concat(o," ").concat(i,"时"):1==t?"".concat(a,"-").concat(n,"-").concat(o):2==t?"".concat(a,"-").concat(n):void 0}var l={data:function(){var t=this.getDate({format:!0});return{project_id:"",date:t,keyword:"",year:"年",month:"月",day:"日",tab_bar:["历史数据","历史曲线"],tab_cur:0,load_text:"",dataList:[],thead:[{text:"项目名称",style:"width: 153upx;"},{text:"PM2.5",style:"width: 88upx;"},{text:"PM 10",style:"width: 91upx;"},{text:"TSP",style:"width: 70upx;"},{text:"标站值",style:"width: 98upx;"},{text:"状态",style:"width: 86upx;"},{text:"时间",style:"width: 106upx;flex:1"}],mescroll:null,downOption:{auto:!1},upOption:{auto:!0,textLoading:"正在加载",textNoMore:"没有更多数据了",page:{num:0,size:20},noMoreSize:5,empty:{}},cWidth:"",cHeight:"",pixelRatio:1,charts_data:{},charts_init:!1,tab:[{text:"每时"},{text:"每日"},{text:"每月"}],tab_index:0,tab_date:s(0)}},computed:{startDate:function(){return"2019-01-01"},endDate:function(){return this.getDate("end")}},onLoad:function(){o=this,o.project_id=o.$Route.query.project_id,o.cWidth=t.upx2px(750),o.cHeight=t.upx2px(450),o.project_id=o.$Route.query.project_id,o.ranking=o.$Route.query.ranking,o.project_name=o.$Route.query.project_name},watch:{tab_cur:function(t){t?(o.tab_index=0,o.keyword=o.tab_index+1,o.getServerData()):o.keyword=""},tab_index:function(t){o.keyword=t+1,o.getServerData(),o.tab_date=s(t)}},onShow:function(){},methods:{changeTab:function(t){o.tab_cur=t},onSwiperChange:function(t){o.tab_cur=t.detail.current},changeAnalysisTab:function(t){o.tab_index=t},getDate:function(t){var e=new Date,a=e.getFullYear(),n=e.getMonth()+1,o=e.getDate();e.getHours();return"start"===t?a-=60:"end"===t&&(a+=2),n=n>9?n:"0"+n,o=o>9?o:"0"+o,"".concat(a,"-").concat(n,"-").concat(o)},bindDateChange:function(t){o.date=t.target.value,o.keyword=o.date;var e=o.date.split("-");o.year=e[0],o.month=e[1],o.day=e[2]},cancel:function(){o.keyword&&(o.keyword="",o.year="年",o.month="月",o.day="日",o.serachAll())},onSerach:function(){o.serachAll()},serachAll:function(){t.showModal({title:"提示",content:"部分数据量较大,如发生延迟，请等待",cancelText:"取消",confirmText:"确定",success:function(t){t.confirm&&(o.load_text="正在加载",o.mescroll.resetUpScroll())},fail:function(){},complete:function(){}})},mescrollInit:function(t){this.mescroll=t},downCallback:function(t){t.resetUpScroll()},upCallback:function(t){o.getListDataFromNet(t.num,t.size,function(e){t.endSuccess(e.length),1==t.num&&(o.dataList=[]),o.dataList=o.dataList.concat(e)},function(){t.endErr()})},getListDataFromNet:function(t,e,a,n){o.getServerData(t,e,a,n)},getServerData:function(e,a,i,r){o.tab_cur&&(o.load_text="",t.showLoading({title:"正在加载"})),o.$ajax({title:o.load_text,path:o.$api.project_history,data:{page:e,pagesize:a,project_id:o.project_id,keyword:o.keyword,type:o.tab_cur+1},success:function(t){var e=t.data,a=e.data;e.code,e.msg;if(o.tab_cur)o.charts_data=a,o.showLineA("canvasLineA",o.charts_data);else{var r=a.map(function(t){return{p_id:t.id,p_td0:t.name,p_td1:t.pm25,p_td2:t.pm10,p_td3:t.tsp,p_td4:t.station_num,p_td5:t.status,p_td6:t.createtime}});console.log(n(r," at pages\\index\\history\\history.vue:307")),setTimeout(function(){i&&i(r)},1e3)}},fail:function(){r&&r()}})},showLineA:function(e,a){var n;u=new i.default({$this:o,canvasId:e,type:"line",fontSize:11,padding:[20,36,0,30],legend:{show:!0,fontSize:10},dataLabel:!1,dataPointShape:!1,background:"#FFFFFF",pixelRatio:o.pixelRatio,categories:a.categories,series:a.series,animation:!0,xAxis:(n={disabled:!0,gridType:"dash",gridColor:"#BBBBBB"},c(n,"gridType","dash"),c(n,"axisLineColor","#BBBBBB"),c(n,"disableGrid",!0),n),yAxis:{disableGrid:!0,gridType:"dash",gridColor:"#BBBBBB",splitNumber:10,data:[{min:0,max:500,calibration:!0,axisLineColor:"#BBBBBB",axisLine:!0}]},width:o.cWidth*o.pixelRatio,height:o.cHeight*o.pixelRatio,extra:{line:{type:"straight"}}}),u.addEventListener("renderComplete",function(){o.charts_init=!0,t.hideLoading()})},touchLineA:function(t){d=Date.now()},moveLineA:function(t){var e=Date.now(),a=e-d;if(!(a<Math.floor(1e3/60))){d=e;var n=u.getCurrentDataIndex(t);n>-1&&u.opts.categories.length,u.showToolTip(t,{format:function(t,e){return e+" "+t.name+":"+t.data}})}},touchEndLineA:function(t){var e=u.getCurrentDataIndex(t);e>-1&&u.opts.categories.length,u.touchLegend(t),u.showToolTip(t,{format:function(t,e){return e+" "+t.name+":"+t.data}})}}};e.default=l}).call(this,a("6e42")["default"],a("0de9")["default"])},"86c2":function(t,e,a){"use strict";var n=a("e350"),o=a.n(n);o.a},d789:function(t,e,a){"use strict";a.r(e);var n=a("34e0"),o=a("3862");for(var i in o)"default"!==i&&function(t){a.d(e,t,function(){return o[t]})}(i);a("86c2");var r=a("2877"),c=Object(r["a"])(o["default"],n["a"],n["b"],!1,null,"6d02e3ec",null);e["default"]=c.exports},e350:function(t,e,a){},f97a:function(t,e,a){"use strict";(function(t){a("c01f"),a("921b");n(a("66fd"));var e=n(a("d789"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("6e42")["createPage"])}},[["f97a","common/runtime","common/vendor"]]]);